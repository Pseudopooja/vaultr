<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Vault Administration — vault_client_operator • vaultr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Vault Administration — vault_client_operator" />

<meta property="og:description" content="Administration commands for vault operators.  Very few of these
commands should be used without consulting the vault documentation
as they affect the administration of a vault server, but they are
included here for completeness." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vaultr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vaultr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/packages.html">Using vaultr in packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vimc/vaultr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Vault Administration</h1>
    <small class="dont-index">Source: <a href='https://github.com/vimc/vaultr/blob/master/R/vault_client_operator.R'><code>R/vault_client_operator.R</code></a></small>
    <div class="hidden name"><code>vault_client_operator.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Administration commands for vault operators.  Very few of these
commands should be used without consulting the vault documentation
as they affect the administration of a vault server, but they are
included here for completeness.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
    <dl class='dl-horizontal'>
<dt><code>key_status</code></dt><dd><p>Return information about the current encryption key of Vault.
  <br /><em>Usage:</em><pre>key_status()</pre></p></dd>
<dt><code>is_initialized</code></dt><dd><p>Returns the initialization status of Vault
  <br /><em>Usage:</em><pre>is_initialized()</pre></p></dd>
<dt><code>init</code></dt><dd><p>This endpoint initializes a new Vault. The Vault must not have been previously initialized.
  <br /><em>Usage:</em><pre>init(secret_shares, secret_threshold)</pre>
    <em>Arguments:</em>
  <ul>
<li><p><code>secret_shares</code>:   Integer, specifying the number of shares to split the master key into</p></li>
<li><p><code>secret_threshold</code>:   Integer, specifying the number of shares required to reconstruct the master key. This must be less than or equal secret_shares</p></li>
</ul></p></dd>
<dt><code>leader_status</code></dt><dd><p>Check the high availability status and current leader of Vault
  <br /><em>Usage:</em><pre>leader_status()</pre></p></dd>
<dt><code>rekey_status</code></dt><dd><p>Reads the configuration and progress of the current rekey attempt
  <br /><em>Usage:</em><pre>rekey_status()</pre></p></dd>
<dt><code>rekey_start</code></dt><dd><p>This method begins a new rekey attempt. Only a single rekey attempt can take place at a time, and changing the parameters of a rekey requires cancelling and starting a new rekey, which will also provide a new nonce.
  <br /><em>Usage:</em><pre>rekey_start(secret_shares, secret_threshold)</pre>
    <em>Arguments:</em>
  <ul>
<li><p><code>secret_shares</code>:   Integer, specifying the number of shares to split the master key into</p></li>
<li><p><code>secret_threshold</code>:   Integer, specifying the number of shares required to reconstruct the master key. This must be less than or equal secret_shares</p></li>
</ul></p></dd>
<dt><code>rekey_cancel</code></dt><dd><p>This method cancels any in-progress rekey. This clears the rekey settings as well as any progress made. This must be called to change the parameters of the rekey. Note: verification is still a part of a rekey. If rekeying is cancelled during the verification flow, the current unseal keys remain valid.
  <br /><em>Usage:</em><pre>rekey_cancel()</pre></p></dd>
<dt><code>rekey_submit</code></dt><dd><p>This method is used to enter a single master key share to progress the rekey of the Vault. If the threshold number of master key shares is reached, Vault will complete the rekey. Otherwise, this method must be called multiple times until that threshold is met. The rekey nonce operation must be provided with each call.
  <br /><em>Usage:</em><pre>rekey_submit(key, nonce)</pre>
    <em>Arguments:</em>
  <ul>
<li><p><code>key</code>:   Specifies a single master share key (a string)</p></li>
<li><p><code>nonce</code>:   Specifies the nonce of the rekey operation (a string)</p></li>
</ul></p></dd>
<dt><code>rotate</code></dt><dd><p>This method triggers a rotation of the backend encryption key. This is the key that is used to encrypt data written to the storage backend, and is not provided to operators. This operation is done online. Future values are encrypted with the new key, while old values are decrypted with previous encryption keys.
  <br /><em>Usage:</em><pre>rotate()</pre></p></dd>
<dt><code>seal</code></dt><dd><p>Seal the vault, preventing any access to it.  After the vault is sealed, it must be unsealed for further use.
  <br /><em>Usage:</em><pre>seal()</pre></p></dd>
<dt><code>seal_status</code></dt><dd><p>Check the seal status of a Vault.  This method can be used even when the client is not authenticated with the vault (which will the case for a sealed vault).
  <br /><em>Usage:</em><pre>seal_status()</pre></p></dd>
<dt><code>unseal</code></dt><dd><p>Submit a portion of a key to unseal the vault.  This method is typically called by multiple different operators to assemble the master key.
  <br /><em>Usage:</em><pre>unseal(key, reset = FALSE)</pre>
    <em>Arguments:</em>
  <ul>
<li><p><code>key</code>:   The master key share</p></li>
<li><p><code>reset</code>:   Logical, indicating if the unseal process should start be started again.</p></li>
</ul></p></dd>
</dl>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>server</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>vaultr</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/vaultr/topics/vault_test_server'>vault_test_server</a></span>(<span class='kw'>if_disabled</span> <span class='kw'>=</span> <span class='no'>message</span>)</div><div class='output co'>#&gt; <span class='message'>...waiting for Vault to start</span></div><div class='input'><span class='no'>client</span> <span class='kw'>&lt;-</span> <span class='no'>server</span>$<span class='fu'>client</span>()

<span class='co'># Our test server is by default unsealed:</span>
<span class='no'>client</span>$<span class='fu'>status</span>()$<span class='no'>sealed</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'># We can seal the vault to prevent all access:</span>
<span class='no'>client</span>$<span class='no'>operator</span>$<span class='fu'>seal</span>()
<span class='no'>client</span>$<span class='fu'>status</span>()$<span class='no'>sealed</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># And then unseal it again</span>
<span class='no'>client</span>$<span class='no'>operator</span>$<span class='fu'>unseal</span>(<span class='no'>server</span>$<span class='no'>keys</span>)</div><div class='output co'>#&gt; $type
#&gt; [1] "shamir"
#&gt; 
#&gt; $initialized
#&gt; [1] TRUE
#&gt; 
#&gt; $sealed
#&gt; [1] FALSE
#&gt; 
#&gt; $t
#&gt; [1] 1
#&gt; 
#&gt; $n
#&gt; [1] 1
#&gt; 
#&gt; $progress
#&gt; [1] 0
#&gt; 
#&gt; $nonce
#&gt; [1] ""
#&gt; 
#&gt; $version
#&gt; [1] "1.0.0"
#&gt; 
#&gt; $migration
#&gt; [1] FALSE
#&gt; 
#&gt; $cluster_name
#&gt; [1] "vault-cluster-d66783a3"
#&gt; 
#&gt; $cluster_id
#&gt; [1] "b8ff2009-fc48-1492-4abb-efdab4a064ff"
#&gt; 
#&gt; $recovery_seal
#&gt; [1] FALSE
#&gt; </div><div class='input'><span class='no'>client</span>$<span class='fu'>status</span>()$<span class='no'>sealed</span></div><div class='output co'>#&gt; [1] FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#methods">Methods</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Robert Ashton, Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

